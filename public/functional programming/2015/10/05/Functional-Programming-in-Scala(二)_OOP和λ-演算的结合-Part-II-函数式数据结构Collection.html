<!DOCTYPE html>
<html lang = "en">
<head>
    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/posts/favico/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/images/posts/favico/favico/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/images/posts/favico/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/images/posts/favico/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/images/posts/favico/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/images/posts/favico/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/images/posts/favico/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/posts/favico/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/posts/favico/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/assets/images/posts/favico/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/posts/favico/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/images/posts/favico/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/posts/favico/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/posts/favico/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/images/posts/favico/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">   

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/font-awesome/css/font-awesome.min.css">
    <link href="/assets/css/styles.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/syntax.css">


    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,600' rel='stylesheet' type='text/css'>
<!--     <script type="text/javascript" src="http://api.youziku.com/webfont/FastJS/yzk_976E121ED7CC0870"></script> -->

    <title>SHUNMIAN</title>
</head>


<body>

    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 sidebar hidden-xs sidebar">
                
<!--sidebar.html-->
        <header class="sidebar_header " role="banner">
            <a href="http://www.shunmian.me/index.html">
                <img src = "https://www.gravatar.com/avatar/02eefecba7f0b21939d12a37f94bf5df?s=150" class="img-circle img-responsive center-block sidebar_logo sidebar_img" />
            </a>


            <h3 class="title text-center">
                <a href="http://www.shunmian.me/index.html">SHUNMIAN</a>
            </h3>

        </header>


        <hr class="hr_short"/>
        <div id = "bio" class="text-center sidebar_bio">
            

                <p>嗨，欢迎来到我的博客。<br/>
                我是Shunmian，一名iOS开发者。<br/>
                <hr class = "hr_short_low">
                正在学习Algorithm，Functional Programming，Machine Learning，Data Mining 和 Cloud Computation。 

                </p>

            
        </div>


        <hr class="hr_middle"/>
        <div id = "contact-list" class="text-center">
            <ul class="list-unstyled list-inline">
                <li>
                    
                    <a class="btn btn_info_outline" href="mailto:shunmian@gmail.com"><i class="fa fa-envelope fa-lg"></i></a>
                    
                </li>

                <li>
                    
                    <a class="btn btn_info_outline" href="https://github.com/shunmian"><i class="fa fa-github fa-lg"></i></a>
                    
                </li>

                <li>
                    
                    <a class="btn btn_info_outline" href="https://github.com/shunmian"><i class="fa fa-twitter fa-lg"></i></a>
                    
                </li>

                <li>
                    <a class="btn btn_info_outline" href="http://www.shunmian.me/feed.xml"><i class="fa fa-rss fa-lg"></i></a>
                </li>
        </div>


        <hr class="hr_short"/>
        <div id = "contact-list" class="text-center">
            <ul class="unstyled-list list-inline">
                <li>
                    <a class="btn btn_info_outline btn-sm" href="http://www.shunmian.me/index.html"><i class="fa fa-home fa-md"></i> 主页</a>
                </li>

                <li>
                    <a class="btn btn_info_outline btn-sm" href="http://www.shunmian.me/tags.html"><i class="fa fa-tags fa-md"></i> 标签</a>
                </li>

                <li>
                    <a class="btn btn_info_outline btn-sm" href="http://www.shunmian.me/categories.html"><i class="fa fa-list fa-md"></i> 分类</a>
                </li>
            </ul>
        </div>
        <div class="padding_bottom_500"></div>




<!--sidebar.html end-->

            </div>

            <div class="col-sm-9 col-sm-offset-3">
                

<div class="page-header col-sm-10 col-sm-offset-1">
    <h1 class="article_mainTitle">FP in Scala(二)：OOP和λ-演算的结合 Part II：函数式数据结构Collection </h1>
    <span class="post_date">
        2015-10-05 •
    </span>
    <span class="post_category">
        Functional Programming
    </span>
</div>

<article class="article">
    <div class="col-sm-10 col-sm-offset-1">
        <div class="article_mainBody">
            <p class="article_content_title">目录</p>

<ul id="markdown-toc">
  <li><a href="#list" id="markdown-toc-list">1. 函数式数据结构的典型：List</a></li>
  <li><a href="#sequence" id="markdown-toc-sequence">2. Sequence</a>    <ul>
      <li><a href="#list-1" id="markdown-toc-list-1">2.1 List</a>        <ul>
          <li><a href="#section" id="markdown-toc-section">2.1 基础</a></li>
          <li><a href="#section-1" id="markdown-toc-section-1">2.2 一阶函数</a>            <ul>
              <li><a href="#tuple" id="markdown-toc-tuple">2.2.1 tuple(元组)</a></li>
              <li><a href="#section-2" id="markdown-toc-section-2">2.2.2 隐式参数</a></li>
            </ul>
          </li>
          <li><a href="#section-3" id="markdown-toc-section-3">2.3 高阶函数</a>            <ul>
              <li><a href="#filter" id="markdown-toc-filter">2.3.1 filter(筛选)</a></li>
              <li><a href="#map" id="markdown-toc-map">2.3.2 map(映射)</a></li>
              <li><a href="#reduce--fold" id="markdown-toc-reduce--fold">2.3.3 reduce(化约) 和 fold(折叠)</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#vector" id="markdown-toc-vector">2.2 Vector</a></li>
      <li><a href="#range" id="markdown-toc-range">2.3 Range</a></li>
      <li><a href="#array--string" id="markdown-toc-array--string">2.4 Array &amp;&amp; String</a></li>
    </ul>
  </li>
  <li><a href="#set" id="markdown-toc-set">3 Set</a></li>
  <li><a href="#map-1" id="markdown-toc-map-1">4 Map</a></li>
  <li><a href="#section-4" id="markdown-toc-section-4">5 总结</a></li>
  <li><a href="#section-5" id="markdown-toc-section-5">6 参考资料</a></li>
</ul>

<hr class="hr-short-left" />

<h2 id="list">1. 函数式数据结构的典型：List</h2>

<h2 id="sequence">2. Sequence</h2>

<h3 id="list-1">2.1 List</h3>

<p class="img_middle_lg"><img src="/assets/images/posts/2015-10-05/list summary.png" alt="List summary" /></p>

<h4 id="section">2.1 基础</h4>

<p><code class="highlighter-rouge">List</code>在Scala里是<strong>immutable</strong>，它的实现是<strong>recursive</strong>的。</p>

<p><code class="highlighter-rouge">List</code>是一个抽象接口<code class="highlighter-rouge">Trait</code>，它的子类个数<code class="highlighter-rouge">Empty</code>和<code class="highlighter-rouge">NonEmpty</code>已经确定下来，因此根据我们上文<a href="http://www.shunmian.me/functional%20programming/2015/10/04/Functional-Programming-in-Scala(二)_OOP和λ-演算的结合-Part-I-万物皆类-&amp;&amp;-函数式的体现.html#Pattern-Matching">Pattern Matching</a>和OOP decompostion的比较，接口方法的扩展在<code class="highlighter-rouge">Trait</code>里用<strong>Pattern Matching</strong>实现尤其方便。</p>

<ol>
<li><b>构造器</b>，所有List从以下两种方法构造出来：</li>
  <ul>
  <li>Nil，表示Empty的单例</li>
  <li>x::xs，表示NonEmpty的实例，等同于 new Cons(x,xs)</li>
  </ul>
<li><b>head，tail，isEmpty</b></li>
  <ul>
  <li>head，NonEmpty的第一个元素，即(x::xs)中的x</li>
  <li>tail，NonEmpty的除了第一个元素外的元素，即(x::xs)中的xs</li>
  <li>isEmpty，NonEmpty是false，Empty是true</li>
  </ul>
<li><b>pattern matching</b></li>，见上图3种情况，分别代表空，1个元素，和多于1个元素的pattern。
</ol>

<h4 id="section-1">2.2 一阶函数</h4>

<p>List一阶函数包括上图几种API，这里就不详细讲解了。
下面我们结合List的<strong>一阶函数</strong>和<strong>pattern matching</strong>，来实现下<strong>merge sort</strong>：</p>

<ol>
  <li>先分一半；</li>
  <li>左右各做sort；</li>
  <li>sort完merge。</li>
</ol>

<p>其实就是典型的<strong>分而治之</strong>的思想，我们先看下用Scala的List如何实现。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre></td><td class="code"><pre> <span class="k">def</span> <span class="n">msort1</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mid</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">x</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span> <span class="n">ys</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="n">ys</span>
        <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">ys</span> <span class="k">match</span> <span class="o">{</span>
          <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="n">xs</span>
          <span class="k">case</span> <span class="n">y</span><span class="o">::</span><span class="n">ys1</span> <span class="k">=&gt;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="n">x</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">ys</span><span class="o">)</span>
            <span class="k">else</span> <span class="n">y</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span> <span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span>
      <span class="n">merge</span><span class="o">(</span><span class="n">msort1</span><span class="o">(</span><span class="n">fst</span><span class="o">),</span> <span class="n">msort1</span><span class="o">(</span><span class="n">snd</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>这里<code class="highlighter-rouge">merge</code>method的<strong>pattern matching</strong>稍显杂乱，我们想要表达的是xs或者ys为空或者不为空的情况，由于用了嵌套的<strong>pattern matching</strong>降低了程序的可读性。我们能否进一步提高呢？</p>

<h5 id="tuple">2.2.1 tuple(元组)</h5>

<p>答案是可以的。我们得用元组。</p>

<blockquote>
  <p><strong>tuple(元组)</strong>：不同与List或者数组(将同样类型的元素组合成一个)，元组是将多个不同类型的变量组合成一个。</p>
</blockquote>

<p>因此我们可以将嵌套<strong>Pattern Matching</strong>简化为一个tuple<code class="highlighter-rouge">(xs,ys)</code>的<strong>Pattern Matching</strong>。代码如下：</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">msort2</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mid</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">x</span>
    <span class="k">else</span><span class="o">{</span>
      <span class="k">def</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span><span class="n">y</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span><span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span><span class="n">y</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span><span class="n">x</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x1</span><span class="o">::</span><span class="n">xs1</span><span class="o">,</span> <span class="n">y1</span><span class="o">::</span><span class="n">ys1</span><span class="o">)</span> <span class="o">=&gt;{</span>
             <span class="k">if</span><span class="o">(</span><span class="n">x1</span> <span class="o">&lt;</span> <span class="n">y1</span><span class="o">)</span> <span class="n">x1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span><span class="n">y</span><span class="o">)</span>
             <span class="k">else</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span><span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span>
      <span class="n">merge</span><span class="o">(</span><span class="n">msort2</span><span class="o">(</span><span class="n">fst</span><span class="o">),</span><span class="n">msort2</span><span class="o">(</span><span class="n">snd</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>元组的语法如下：</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2</pre></td><td class="code"><pre><span class="k">val</span> <span class="n">pair</span> <span class="k">=</span> <span class="o">(</span><span class="s">"answer"</span><span class="o">,</span><span class="mi">42</span><span class="o">)</span>  
<span class="k">val</span> <span class="o">(</span><span class="n">label</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span> <span class="k">=</span> <span class="n">pair</span> <span class="o">//</span><span class="n">label</span> <span class="k">=</span> <span class="s">"answer"</span><span class="o">,</span> <span class="n">value</span> <span class="k">=</span> <span class="mi">42</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>由上面的例子可以看到元组的使用，可以将多参数表示成单参数(子参数平行)，使得代码的逻辑和可读性大大增强。</p>

<h5 id="section-2">2.2.2 隐式参数</h5>

<p>上面的例子只是对于<code class="highlighter-rouge">List[Int]</code>来进行排序，能否用<strong>泛型将type参数化</strong>呢？答案是可以的。关键要在merge函数里实现<code class="highlighter-rouge">x &lt; y</code>的定义。因此我们得输入另一个<code class="highlighter-rouge">lt:(T,T)=&gt;Boolean</code>的参数给msort。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">msort3</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">lt</span><span class="k">:</span><span class="o">(</span><span class="kt">T</span><span class="o">,</span><span class="kt">T</span><span class="o">)</span><span class="k">=&gt;</span><span class="nc">Boolean</span><span class="o">)</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mid</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">x</span>
    <span class="k">else</span><span class="o">{</span>
      <span class="k">def</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span><span class="n">y</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span><span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span><span class="n">y</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span><span class="n">x</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x1</span><span class="o">::</span><span class="n">xs1</span><span class="o">,</span> <span class="n">y1</span><span class="o">::</span><span class="n">ys1</span><span class="o">)</span> <span class="o">=&gt;{</span>
             <span class="k">if</span><span class="o">(</span><span class="n">lt</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span><span class="n">y1</span><span class="o">))</span> <span class="n">x1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span><span class="n">y</span><span class="o">)</span>
             <span class="k">else</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span><span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span>
      <span class="n">merge</span><span class="o">(</span><span class="n">msort3</span><span class="o">(</span><span class="n">fst</span><span class="o">)(</span><span class="n">lt</span><span class="o">),</span><span class="n">msort3</span><span class="o">(</span><span class="n">snd</span><span class="o">)(</span><span class="n">lt</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">val</span> <span class="n">numbers</span> <span class="k">=</span>  <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">6</span><span class="o">,-</span><span class="mi">10</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
  <span class="n">msort3</span><span class="o">(</span><span class="n">numbers</span><span class="o">)((</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">&lt;</span><span class="n">y</span><span class="o">)</span>

  <span class="k">val</span> <span class="n">fruits</span> <span class="k">=</span>  <span class="nc">List</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"pear"</span><span class="o">,</span> <span class="s">"watermelon"</span><span class="o">,</span><span class="s">"banana"</span><span class="o">)</span> 
  <span class="n">msort3</span><span class="o">(</span><span class="n">fruits</span><span class="o">)((</span><span class="n">x</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span><span class="n">y</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">.</span><span class="n">compareTo</span><span class="o">(</span><span class="n">y</span><span class="o">)&lt;</span><span class="mi">0</span><span class="o">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>在调用<code class="highlighter-rouge">msort3</code>的时候，我们得显示提供这个比较参数。</p>

<p>那么对于基础类型的比较，scala有没有已经实现了的方法，比如Java里的<code class="highlighter-rouge">Comparable</code>接口，从而可以简化我们的比较函数呢，答案也是可以的。我们得用到<code class="highlighter-rouge">scala.math.Orderinng</code>类。
代码如下：</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">msort4</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">ord</span><span class="k">:</span><span class="kt">Ordering</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mid</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">x</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">y</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">y</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x1</span> <span class="o">::</span> <span class="n">xs1</span><span class="o">,</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">ys1</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">ord</span><span class="o">.</span><span class="n">lt</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">))</span> <span class="n">x1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="c1">//用Ordring的lt方法。
</span>          <span class="k">else</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span> <span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span>
      <span class="n">merge</span><span class="o">(</span><span class="n">msort4</span><span class="o">(</span><span class="n">fst</span><span class="o">)(</span><span class="n">ord</span><span class="o">),</span> <span class="n">msort4</span><span class="o">(</span><span class="n">snd</span><span class="o">)(</span><span class="n">ord</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="k">val</span> <span class="n">numbers</span> <span class="k">=</span>  <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">6</span><span class="o">,-</span><span class="mi">10</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
<span class="n">msort</span><span class="o">(</span><span class="n">numbers</span><span class="o">(</span><span class="nc">Ordering</span><span class="o">.</span><span class="nc">Int</span><span class="o">)</span>

<span class="k">val</span> <span class="n">fruits</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"pear"</span><span class="o">,</span> <span class="s">"watermelon"</span><span class="o">,</span><span class="s">"banana"</span><span class="o">)</span> 
<span class="n">msort</span><span class="o">(</span><span class="n">fruits</span><span class="o">)(</span><span class="nc">Ordering</span><span class="o">.</span><span class="nc">String</span><span class="o">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>最后我们可以用<code class="highlighter-rouge">implicit ord: Ordering[T]</code>在<code class="highlighter-rouge">msort</code>定义和时作为输入参数</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">msort</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="k">implicit</span> <span class="n">ord</span><span class="k">:</span> <span class="kt">Ordering</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mid</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">mid</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="n">x</span>
    <span class="k">else</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">],</span> <span class="n">y</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">match</span> <span class="o">{</span>
        <span class="k">case</span> <span class="o">(</span><span class="nc">Nil</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">y</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span>
        <span class="k">case</span> <span class="o">(</span><span class="n">x1</span> <span class="o">::</span> <span class="n">xs1</span><span class="o">,</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">ys1</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">{</span>
          <span class="k">if</span> <span class="o">(</span><span class="n">ord</span><span class="o">.</span><span class="n">lt</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span> <span class="n">y1</span><span class="o">))</span> <span class="n">x1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">xs1</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
          <span class="k">else</span> <span class="n">y1</span> <span class="o">::</span> <span class="n">merge</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">ys1</span><span class="o">)</span>
        <span class="o">}</span>
      <span class="o">}</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span> <span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">mid</span><span class="o">)</span>
      <span class="n">merge</span><span class="o">(</span><span class="n">msort</span><span class="o">(</span><span class="n">fst</span><span class="o">),</span> <span class="n">msort</span><span class="o">(</span><span class="n">snd</span><span class="o">))</span> <span class="c1">//ord 对merge可见，因此可以省略
</span>    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">val</span> <span class="n">numbers</span> <span class="k">=</span>  <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">6</span><span class="o">,-</span><span class="mi">10</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>
  <span class="n">msort</span><span class="o">(</span><span class="n">numbers</span><span class="o">)</span>                    <span class="c1">//调用时，也不需要提供Ordering实例，Scala会自己判断
</span>
  <span class="k">val</span> <span class="n">fruits</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"pear"</span><span class="o">,</span> <span class="s">"watermelon"</span><span class="o">,</span><span class="s">"banana"</span><span class="o">)</span> 
  <span class="n">msort</span><span class="o">(</span><span class="n">fruits</span><span class="o">)</span>                     <span class="o">//</span><span class="n">调用时</span><span class="err">，</span><span class="n">也不需要提供Ordering实例</span><span class="err">，</span><span class="nc">Scala会自己判断</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h4 id="section-3">2.3 高阶函数</h4>

<p>好了，铺垫了前面4篇文章和本文前面的List基础和一阶函数。我们终于来到了List的高阶函数了，这相当于FP的第一道主食，前面都是开胃小菜，等待了那么久，第一道硬菜终于上桌了。我们来好好享受函数式数据结构List高阶函数带来的<strong>解决什么问题</strong>而不是<strong>怎样解决问题</strong>这么一个函数式编程广为赞誉的特性。</p>

<p>函数式编程高阶函数一般解决以下三个问题：</p>

<ol>
  <li><strong>filter(筛选)</strong>，retrieving a list of all elements satifying a criterion；</li>
  <li><strong>map(映射)</strong>，transforming each elements in a list；</li>
  <li><strong>reduce(化约)和fold(折叠)</strong>，combining elements of a list using an operator。</li>
</ol>

<h5 id="filter">2.3.1 filter(筛选)</h5>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">filter</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">p</span><span class="k">:</span><span class="kt">T</span><span class="o">=&gt;</span><span class="nc">Boolean</span><span class="o">)</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="nc">Nil</span>
    <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="k">if</span> <span class="o">(</span><span class="n">p</span><span class="o">(</span><span class="n">x</span><span class="o">))</span> <span class="n">x</span><span class="o">::</span><span class="n">filter</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">p</span><span class="o">)</span> <span class="k">else</span> <span class="n">filter</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">p</span><span class="o">)</span>
  <span class="o">}</span>                                               
  
  <span class="k">val</span> <span class="n">numbers</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">6</span><span class="o">,-</span><span class="mi">10</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>      <span class="c1">//List(-4, 2, 6, -10, 9, 8, 5)
</span>  <span class="k">val</span> <span class="n">fNumers</span> <span class="k">=</span> <span class="n">filter</span><span class="o">(</span><span class="n">numbers</span><span class="o">)(</span><span class="n">x</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">)</span>    <span class="o">//</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>我们定义了一个高阶函数(Currying)来实现多参数的输入(xs和p)。若xs是空则返回空；若不是空，则判断是否通过条件，通过则留下，进一步filter剩下的，否则直接filter剩下的。</p>

<p>那么我们使用<code class="highlighter-rouge">filter</code>的时候，只需要在提供一个List实例之外，提供一个<code class="highlighter-rouge">p:(T)=&gt;Boolean</code>(也就是解决每个元素通过的规则的问题)，就可以获得最终符合条件的元素组成的List。</p>

<h5 id="map">2.3.2 map(映射)</h5>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">map</span><span class="o">[</span><span class="kt">T</span>,<span class="kt">U</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">p</span><span class="k">:</span><span class="kt">T</span><span class="o">=&gt;</span><span class="n">U</span><span class="o">)</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">U</span><span class="o">]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="nc">Nil</span>
    <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">p</span><span class="o">(</span><span class="n">x</span><span class="o">)::</span><span class="n">map</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">p</span><span class="o">)</span>
  <span class="o">}</span>     

  <span class="k">val</span> <span class="n">numbers</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(-</span><span class="mi">4</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">6</span><span class="o">,-</span><span class="mi">10</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">5</span><span class="o">)</span>      <span class="c1">//List(-4, 2, 6, -10, 9, 8, 5)
</span>  <span class="k">val</span> <span class="n">mapNumbers</span> <span class="k">=</span> <span class="n">map</span><span class="o">(</span><span class="n">numbers</span><span class="o">)((</span><span class="n">x</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="o">)</span> <span class="o">//</span><span class="nc">List</span><span class="o">(</span><span class="mi">16</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">81</span><span class="o">,</span> <span class="mi">64</span><span class="o">,</span> <span class="mi">25</span><span class="o">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>同理，我们有了一个一一对应的<code class="highlighter-rouge">map</code>函数，只需要提供一个List实例和<code class="highlighter-rouge">p:(U)=&gt;T</code>(解决每个元素映射的规则的问题)，就可以获得一个新的映射后的List。</p>

<h5 id="reduce--fold">2.3.3 reduce(化约) 和 fold(折叠)</h5>

<p><strong>reduce(化约)和fold(折叠)</strong>是combining elements of a list using an operator。分别分为<strong>reduceLeft(左化约)</strong>，<strong>foldLeft(左折叠)</strong>；以及<strong>reduceRight(右化约)</strong>，<strong>foldRight(右折叠)</strong>。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">foldLeft</span><span class="o">[</span><span class="kt">T</span>,<span class="kt">U</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">z</span><span class="k">:</span><span class="kt">U</span><span class="o">)(</span><span class="n">op</span><span class="k">:</span><span class="o">(</span><span class="kt">T</span><span class="o">,</span><span class="kt">U</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">U</span><span class="o">)</span><span class="k">:</span><span class="kt">U</span> <span class="o">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="n">z</span>
    <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">foldLeft</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">op</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">z</span><span class="o">))(</span><span class="n">op</span><span class="o">)</span>
  <span class="o">}</span>                       
  
  <span class="k">def</span> <span class="n">reduceLeft</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">op</span><span class="k">:</span><span class="o">(</span><span class="kt">T</span><span class="o">,</span><span class="kt">T</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">T</span><span class="o">)</span><span class="k">:</span><span class="kt">T</span> <span class="o">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="o">(</span><span class="s">"Nil.reduceLeft"</span><span class="o">)</span>
    <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">foldLeft</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">x</span><span class="o">)(</span><span class="n">op</span><span class="o">)</span>
  <span class="o">}</span>                                              
  
  <span class="k">val</span> <span class="n">rlNumber</span> <span class="k">=</span> <span class="n">reduceLeft</span><span class="o">(</span><span class="mi">0</span><span class="o">::</span><span class="n">numbers</span><span class="o">)((</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">)</span> <span class="c1">//&gt; rlNumber  : Int = 16
</span>  <span class="k">val</span> <span class="n">flNumber</span> <span class="k">=</span> <span class="n">foldLeft</span><span class="o">(</span><span class="n">numbers</span><span class="o">)(</span><span class="mi">0</span><span class="o">)((</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">)</span>   <span class="o">//&gt;</span> <span class="n">flNumber</span>  <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">16</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p><code class="highlighter-rouge">reduceLeft</code>是<code class="highlighter-rouge">folderLeft</code>的特殊形式。</p>

<p><strong>reduceRight，folderRight</strong>类似于<strong>reduceLeft，folderLeft</strong>，只不过不是从<strong>List头</strong>开始，而是从<strong>List尾开始</strong></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre>   <span class="k">def</span> <span class="n">foldRight</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">U</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">z</span><span class="k">:</span> <span class="kt">U</span><span class="o">)(</span><span class="n">op</span><span class="k">:</span> <span class="o">(</span><span class="kt">T</span><span class="o">,</span> <span class="kt">U</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">U</span><span class="o">)</span><span class="k">:</span> <span class="kt">U</span> <span class="o">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span>      <span class="k">=&gt;</span> <span class="n">z</span>
    <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">op</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">foldRight</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">z</span><span class="o">)(</span><span class="n">op</span><span class="o">))</span>
  <span class="o">}</span>                                               

  <span class="k">def</span> <span class="n">reduceRight</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])(</span><span class="n">op</span><span class="k">:</span> <span class="o">(</span><span class="kt">T</span><span class="o">,</span> <span class="kt">T</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="n">xs</span> <span class="k">match</span> <span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span>      <span class="k">=&gt;</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="o">(</span><span class="s">"Nil.reduceLeft"</span><span class="o">)</span>
    <span class="k">case</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs1</span> <span class="k">=&gt;</span> <span class="n">foldRight</span><span class="o">(</span><span class="n">xs1</span><span class="o">)(</span><span class="n">x</span><span class="o">)(</span><span class="n">op</span><span class="o">)</span>
  <span class="o">}</span>                                             
  
  <span class="k">val</span> <span class="n">rrNumber1</span> <span class="k">=</span> <span class="n">reduceRight</span><span class="o">(</span><span class="mi">0</span><span class="o">::</span><span class="n">numbers</span><span class="o">)((</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">)</span>  <span class="c1">//&gt; rlNumber1  : Int = 16
</span>  <span class="k">val</span> <span class="n">frNumber1</span> <span class="k">=</span> <span class="n">foldRight</span><span class="o">(</span><span class="n">numbers</span><span class="o">)(</span><span class="mi">0</span><span class="o">)((</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">)</span>    <span class="o">//&gt;</span> <span class="n">rlNumber1</span>  <span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">16</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>因此一个List元素求和和元素求积的函数可以方便表示成下列代码：</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>   <span class="c1">//((x:Int,y:Int)=&gt;x+y) 可以简写成_+_，第一个"_"表示第一个输入参数，第二个"_"表示第二个输入参数
</span>  <span class="k">def</span> <span class="n">sum0</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="n">reduceLeft</span><span class="o">(</span><span class="mi">0</span><span class="o">::</span><span class="n">xs</span><span class="o">)(</span><span class="k">_</span><span class="o">+</span><span class="k">_</span><span class="o">)</span> 
  <span class="k">def</span> <span class="n">sum1</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="n">foldLeft</span><span class="o">(</span><span class="n">xs</span><span class="o">)(</span><span class="mi">0</span><span class="o">)(</span><span class="k">_</span><span class="o">+</span><span class="k">_</span><span class="o">)</span>
                                              
  <span class="n">sum0</span><span class="o">(</span><span class="n">numbers</span><span class="o">)</span>                            <span class="c1">//&gt; res0: Int = 16
</span>  <span class="n">sum1</span><span class="o">(</span><span class="n">numbers</span><span class="o">)</span>                            <span class="c1">//&gt; res1: Int = 16
</span>  

  <span class="k">def</span> <span class="n">prod0</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="n">reduceLeft</span><span class="o">(</span><span class="mi">1</span><span class="o">::</span><span class="n">xs</span><span class="o">)(</span><span class="k">_</span><span class="o">*</span><span class="k">_</span><span class="o">)</span> 
  <span class="k">def</span> <span class="n">prod1</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">Int</span> <span class="o">=</span> <span class="n">foldLeft</span><span class="o">(</span><span class="n">xs</span><span class="o">)(</span><span class="mi">1</span><span class="o">)(</span><span class="k">_</span><span class="o">*</span><span class="k">_</span><span class="o">)</span>
                                                  
  <span class="n">prod0</span><span class="o">(</span><span class="n">numbers</span><span class="o">)</span>                           <span class="c1">//&gt; res2: Int = 172800
</span>  <span class="n">prod1</span><span class="o">(</span><span class="n">numbers</span><span class="o">)</span>                           <span class="o">//&gt;</span> <span class="n">res3</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">172800</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>下面是一个练习，如何实现一个<code class="highlighter-rouge">pack[T](xs:List[T]):List[List[T]]</code>，当<code class="highlighter-rouge">xs = List('a','a','a','b','d','d','d','d','a')</code>时，输出<code class="highlighter-rouge">xs = List(List('a','a','a'),List('b',1),List('d','d','d','d'),List('a'))</code>。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">pack</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]]</span> <span class="k">=</span> <span class="n">xs</span> <span class="k">match</span><span class="o">{</span>
    <span class="k">case</span> <span class="nc">Nil</span> <span class="k">=&gt;</span> <span class="nc">Nil</span>
    <span class="k">case</span> <span class="n">x</span><span class="o">::</span><span class="n">xs1</span> <span class="k">=&gt;</span> <span class="o">{</span>
      <span class="k">val</span> <span class="o">(</span><span class="n">fst</span><span class="o">,</span><span class="n">snd</span><span class="o">)</span> <span class="k">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">span</span><span class="o">(</span><span class="n">y</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">==</span><span class="n">y</span><span class="o">)</span>
      <span class="n">fst</span><span class="o">::</span><span class="n">pack</span><span class="o">(</span><span class="n">snd</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>进一步如何实现一个<code class="highlighter-rouge">encode[T](xs:List[T]):List[(T,Int))]</code>，当<code class="highlighter-rouge">xs = List('a','a','a','b','d','d','d','d','a')</code>时，输出<code class="highlighter-rouge">xs = List(List('a',3),List('b',1),List('d',4),List('a',1))</code>。我们可以用<strong>Pattern Matching</strong>类似<code class="highlighter-rouge">pack</code>一样实现。但是可以用另外一种思路，就是对<code class="highlighter-rouge">pack</code>的输出进行<code class="highlighter-rouge">map</code>，相当于将xs进行<code class="highlighter-rouge">pack</code>后再进行<code class="highlighter-rouge">map</code>的<strong>链式transformation</strong>。<strong>链式transformation</strong>在函数式编程中尤其有用，可以将十几行的命令式编程的代码用一条代码解决，简洁紧凑。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>  <span class="k">def</span> <span class="n">pack</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">xs</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span><span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">T</span><span class="o">]]</span> <span class="k">=</span> <span class="n">pack</span><span class="o">(</span><span class="n">xs</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">ys</span><span class="o">=&gt;(</span><span class="n">ys</span><span class="o">.</span><span class="n">head</span><span class="o">,</span><span class="n">ys</span><span class="o">.</span><span class="n">length</span><span class="o">))</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>最后用一张图对List进行总结：</p>

<h3 id="vector">2.2 Vector</h3>

<p class="img_middle_mid"><img src="/assets/images/posts/2015-10-05/vector summary.png" alt="vector summary" /></p>

<p>Vector的API大部分和List一样，主要区别是Vector适合操作大量数据而List适合那些操作(head::tail)模型的操作。对于32位为单位的Vector，它的深度M = log32(N)~O(lgN)，因此对于大量数据的读取，优于List的O(N)(List的元素不会保证在一个page上)。</p>

<p>Vector可以用<code class="highlighter-rouge">toList</code>转换成List，也可以用<code class="highlighter-rouge">x+:xs</code>或者<code class="highlighter-rouge">xs:+x</code>分别在Vector<code class="highlighter-rouge">xs</code>头尾增加<code class="highlighter-rouge">x</code>。</p>

<p>用Vector实现向量的点积运算。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>   <span class="k">def</span> <span class="n">scalarProduct</span><span class="o">(</span><span class="n">xs</span><span class="k">:</span><span class="kt">Vector</span><span class="o">[</span><span class="kt">Double</span><span class="o">],</span><span class="n">ys</span><span class="k">:</span><span class="kt">Vector</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span><span class="k">:</span><span class="kt">Double</span> <span class="o">=</span> <span class="o">(</span><span class="n">xs</span><span class="o">.</span><span class="n">zip</span><span class="o">(</span><span class="n">ys</span><span class="o">)).</span><span class="n">map</span><span class="o">(</span><span class="n">xy</span><span class="k">=&gt;</span><span class="n">xy</span><span class="o">.</span><span class="n">_1</span><span class="o">*</span><span class="n">xy</span><span class="o">.</span><span class="n">_2</span><span class="o">).</span><span class="n">sum</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="range">2.3 Range</h3>

<p><code class="highlighter-rouge">Range</code>表示一个有[lowerBound,UpperBound]和nonZero Step的整数序列。</p>

<p class="img_middle_mid"><img src="/assets/images/posts/2015-10-05/range summary.png" alt="range summary" /></p>

<p>下面实现一个简单的栗子。给定两个整数N,M，给出所有的组合(i,j)，使得1&lt;=i&lt;= N且1&lt;=j&lt;= M；</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>   <span class="k">def</span> <span class="n">combine</span><span class="o">(</span><span class="n">N</span><span class="k">:</span><span class="kt">Int</span><span class="o">)(</span><span class="n">M</span><span class="k">:</span><span class="kt">Int</span><span class="o">)</span><span class="k">=</span> <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="n">N</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="n">M</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">y</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)))</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h3 id="array--string">2.4 Array &amp;&amp; String</h3>

<p>Array和String在Scala里也是Sequence的子类，实现是Java的Array和String。但是对它们进行类似List的高阶函数的时候，它们会被自动转换成Sequence。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="code"><pre>  <span class="k">val</span> <span class="n">numbs</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">7</span><span class="o">)</span>             <span class="c1">//&gt; numbs  : Array[Int] = Array(1, 2, 6, 3, 9, 7)
</span>  <span class="k">val</span> <span class="n">mNumbers</span> <span class="k">=</span> <span class="n">numbs</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>                 <span class="c1">//&gt; mNumbers  : Array[Int] = Array(2, 4, 12, 6, 18, 14)
</span>
  <span class="k">val</span> <span class="n">strings</span> <span class="k">=</span> <span class="s">"Hello, World"</span>                    <span class="c1">//&gt; strings  : String = Hello, World
</span>  <span class="k">val</span> <span class="n">fStrings</span> <span class="k">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">isUpper</span><span class="o">)</span>        <span class="c1">//&gt; fStrings  : String = HW
</span>
  <span class="n">strings</span><span class="o">.</span><span class="n">exists</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">isUpper</span><span class="o">)</span>                       <span class="c1">//&gt; res0: Boolean = true
</span>  <span class="n">strings</span><span class="o">.</span><span class="n">forall</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">isUpper</span><span class="o">)</span>                       <span class="c1">//&gt; res1: Boolean = false
</span>
  <span class="k">val</span> <span class="n">zip</span> <span class="k">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">zip</span><span class="o">(</span><span class="n">numbs</span><span class="o">)</span>                    <span class="c1">//&gt; zip  : scala.collection.immutable.IndexedSeq[(Char, Int)] = Vector((H,1), (e
</span>                                                  <span class="c1">//| ,2), (l,6), (l,3), (o,9), (,,7))
</span>  <span class="k">val</span> <span class="n">unzip</span> <span class="k">=</span> <span class="n">zip</span><span class="o">.</span><span class="n">unzip</span>                           <span class="c1">//&gt; unzip  : (scala.collection.immutable.IndexedSeq[Char], scala.collection.immu
</span>                                                  <span class="c1">//| table.IndexedSeq[Int]) = (Vector(H, e, l, l, o, ,),Vector(1, 2, 6, 3, 9, 7))
</span>                                                  <span class="c1">//| 
</span>  <span class="k">val</span> <span class="n">flatMap</span> <span class="k">=</span> <span class="n">numbs</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="o">))</span><span class="c1">//&gt; flatMap  : Array[Int] = Array(1, 2, 2, 4, 6, 12, 3, 6, 9, 18, 7, 14)
</span>
  <span class="n">numbs</span><span class="o">.</span><span class="n">sum</span>                                       <span class="c1">//&gt; res2: Int = 28
</span>  <span class="n">numbs</span><span class="o">.</span><span class="n">product</span>                                   <span class="c1">//&gt; res3: Int = 2268
</span>  <span class="n">numbs</span><span class="o">.</span><span class="n">max</span>                                       <span class="c1">//&gt; res4: Int = 9
</span>  <span class="n">numbs</span><span class="o">.</span><span class="n">min</span>                                       <span class="o">//&gt;</span> <span class="n">res5</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">1</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="set">3 Set</h2>

<p><code class="highlighter-rouge">Set</code>没有序列，也不存在重复的元素。</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre>  <span class="k">val</span> <span class="n">fruit</span> <span class="k">=</span> <span class="nc">Set</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span><span class="s">"banana"</span><span class="o">,</span><span class="s">"pearl"</span><span class="o">,</span><span class="s">"appp"</span><span class="o">)</span><span class="c1">//&gt; fruit  : scala.collection.immutable.Set[String] = Set(apple, banana, pearl, 
</span>                                                  <span class="c1">//| appp)
</span>  <span class="k">val</span> <span class="n">s</span> <span class="k">=</span> <span class="o">(</span><span class="mi">1</span> <span class="n">to</span> <span class="mi">6</span><span class="o">).</span><span class="n">toSet</span>                          <span class="c1">//&gt; s  : scala.collection.immutable.Set[Int] = Set(5, 1, 6, 2, 3, 4)
</span>  <span class="n">fruit</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">startsWith</span><span class="o">(</span><span class="s">"app"</span><span class="o">))</span>               <span class="c1">//&gt; res0: scala.collection.immutable.Set[String] = Set(apple, appp)
</span>  <span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">+</span><span class="mi">2</span><span class="o">)</span>                                      <span class="c1">//&gt; res1: scala.collection.immutable.Set[Int] = Set(5, 6, 7, 3, 8, 4)
</span>  <span class="n">s</span><span class="o">.</span><span class="n">nonEmpty</span>  <span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="map-1">4 Map</h2>

<p><code class="highlighter-rouge">Map</code>是一个key对应一个value，有以下四点需要注意：</p>

<ol>
  <li><code class="highlighter-rouge">Map</code>可作为高阶函数映射的输入参数，因为它本质上是一个函数，给定输入，有固定输出值；</li>
  <li><code class="highlighter-rouge">Map</code>对值的access有两种方式。capitalOfCountry(“US”)`返回可以是异常，当没有这个value的时候；而capitalOfCountry.get(“China”)返回可以是Option(None)，也可以是Option(String)，不会抛异常。关于可选值<strong>Option</strong>我们在下节中详细介绍。</li>
  <li><code class="highlighter-rouge">Map</code>可以有默认值，使得<code class="highlighter-rouge">capitalOfCountry("US")</code>异常取消，返回一个固定值。实现用 <code class="highlighter-rouge">withDefaultValue()</code>；</li>
  <li><code class="highlighter-rouge">Collection</code>可以通过<code class="highlighter-rouge">groupBy</code>转换成<code class="highlighter-rouge">Map</code>。<code class="highlighter-rouge">groupBy[K,V](f: V=&gt;K): Map[K，List[V]]</code>，其中K是新的Map的键值。</li>
</ol>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre>   
  <span class="c1">//1. Map as input argument for map
</span>  <span class="k">val</span> <span class="n">romanNumerals</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">"I"</span><span class="o">-&gt;</span><span class="mi">1</span><span class="o">,</span><span class="s">"V"</span><span class="o">-&gt;</span><span class="mi">5</span><span class="o">,</span> <span class="s">"X"</span><span class="o">-&gt;</span><span class="mi">10</span><span class="o">)</span> <span class="c1">//Map(I -&gt; 1, V-&gt; 5, X -&gt; 10)
</span>  <span class="k">val</span> <span class="n">romans</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"I"</span><span class="o">,</span><span class="s">"V"</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">romanNumerals</span><span class="o">)</span>   <span class="c1">//List[Int] = List(1, 5)
</span>  
  <span class="c1">//2. Map's two way to access elements
</span>  <span class="k">val</span> <span class="n">capitalOfCountry</span> <span class="k">=</span> <span class="nc">Map</span><span class="o">(</span><span class="s">"US"</span><span class="o">-&gt;</span><span class="s">"Washington"</span><span class="o">,</span><span class="s">"Switzerland"</span><span class="o">-&gt;</span><span class="s">"Bern"</span><span class="o">)</span>
                                                  <span class="c1">//Map(US -&gt; Washington, Switzerland -&gt; Bern)
</span>  <span class="n">capitalOfCountry</span><span class="o">(</span><span class="s">"US"</span><span class="o">)</span>                          <span class="c1">//String = Washington
</span>  <span class="n">capitalOfCountry</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">"China"</span><span class="o">)</span>                   <span class="c1">//Option[String] = None
</span>  <span class="n">capitalOfCountry</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">"US"</span><span class="o">)</span>                      <span class="c1">//Option[String] = Some(Washington)
</span>  
  <span class="c1">//3. Map add default value
</span>  <span class="k">val</span> <span class="n">capitalOfCountry2</span> <span class="k">=</span> <span class="n">capitalOfCountry</span><span class="o">.</span><span class="n">withDefaultValue</span><span class="o">(</span><span class="s">"not found"</span><span class="o">)</span>
                                                  <span class="c1">//Map(US -&gt; Washington, Switzerland -&gt; Bern)
</span>  <span class="n">capitalOfCountry2</span><span class="o">(</span><span class="s">"China"</span><span class="o">)</span>                      <span class="c1">//String = not found
</span>  
  <span class="c1">//4. convert List to Map by groupBy
</span>  <span class="k">val</span> <span class="n">fruits</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span><span class="s">"pear"</span><span class="o">,</span><span class="s">"pineapple"</span><span class="o">,</span><span class="s">"orange"</span><span class="o">)</span>
                                                  <span class="c1">//List(apple, pear, pineapple, orange)
</span>  <span class="n">fruits</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="n">x</span><span class="k">=&gt;</span><span class="n">x</span><span class="o">.</span><span class="n">head</span><span class="o">)</span>                       <span class="o">//</span><span class="nc">Map</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">pear</span><span class="o">,</span><span class="n">pineapple</span><span class="o">),</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">apple</span><span class="o">),</span> <span class="n">o</span> <span class="o">-&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="n">orange</span><span class="o">))</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<h2 id="section-4">5 总结</h2>

<p class="img_middle_hg"><img src="/assets/images/posts/2015-10-05/collection hierachy.png" alt="collection hierachy" /></p>

<h2 id="section-5">6 参考资料</h2>

<ul>
  <li><a href="https://mitpress.mit.edu/sicp/full-text/book/book.html">《Structure and Interpretation of Computer Programs》</a>;</li>
  <li><a href="https://www.youtube.com/watch?v=kkTFx3-duc8">Martin Odersky: Scala with Style</a>;</li>
  <li><a href="https://www.youtube.com/watch?v=ecekSCX3B4Q">SF Scala: Martin Odersky, Scala – the Simple Parts</a>;</li>
  <li><a href="https://www.youtube.com/watch?v=v1IlyzxP6Sg">Programming Languages: Lambda Calculus</a>;</li>
  <li><a href="http://www.defmacro.org/ramblings/fp.html">Functional Programming For The Rest of Us</a>;</li>
</ul>


            <div class="clearfix"></div>
        </div>


    
    <ul class="tag_box list-unstyled list-inline">
      <li><i class="fa fa-folder-open"></i></li>
      
      
      
        <li><a href="http://www.shunmian.me/categories.html#Functional Programming-ref">
          Functional Programming <span>(8)</span>
          
        </a></li>
      
      
    </ul>
    

    
    <ul class="list-inline">
      <li><i class="fa fa-tags"></i></li>
      
      
      
        <li>
          <a href="http://www.shunmian.me/tags.html#OOP&&FP-ref">
          OOP&&FP <span>(5)</span>
          
          </a>
        </li>
      
      
      
    </ul>
    

<hr />
<div >
    <section class="col-sm-7">
        <h4>Share Post</h4>
        <a class="btn btn-default btn-sm" href="http://twitter.com/share?text=FP in Scala(二)：OOP和λ-演算的结合 Part II：函数式数据结构Collection&via=Wanderl29817400" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <i class="fa fa-twitter fa-sm"></i>
        Twitter
        </a>

        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-sm"></i>
          Facebook
        </a>

        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-sm"></i>
          Google+
        </a>
    </section>

    <section class="col-sm-5">
        <img src = "https://www.gravatar.com/avatar/02eefecba7f0b21939d12a37f94bf5df" class="img-rounded" />
        <h4>Shunmian</h4>
        <p class="author-bio">节物风光不相待，桑田碧海须臾改，唯有美食和code不可辜负。</p>

    </section>

</div>
<div class="clearfix"></div>

<ul class="pager">
    
    <li class="previous"><a href="http://www.shunmian.me/functional%20programming/2015/10/04/Functional-Programming-in-Scala(%E4%BA%8C)_OOP%E5%92%8C%CE%BB-%E6%BC%94%E7%AE%97%E7%9A%84%E7%BB%93%E5%90%88-Part-I-%E4%B8%87%E7%89%A9%E7%9A%86%E7%B1%BB-&&-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%9A%84%E4%BD%93%E7%8E%B0.html" title= "">&larr; Previous</a></li>
    
    
    <li class="next">"<a href="http://www.shunmian.me/functional%20programming/2015/10/06/Functional-Programming-in-Scala(%E4%BA%8C)_OOP%E5%92%8C%CE%BB-%E6%BC%94%E7%AE%97%E7%9A%84%E7%BB%93%E5%90%88-Part-III-%E5%8F%AF%E9%80%89%E5%80%BC-for-expression-example.html" title= "FP in Scala(二)：OOP和λ-演算的结合 Part III：可选值，for-exp">Next &rarr;</a></li>
    
</ul>

    <hr />
    
    <section class="comments" style="margin-top:15px;">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'shunmianjohnson'; // required: replace example with your forum shortname
        if(disqus_shortname){
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        }
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </section>
    
    </div>
    <div class="col-sm-1sidebar-2"></div>
    <div class="clearfix"></div>
</article>
<div class="clearfix"></div>


                <div class="footer">
                    <footer>
                        <hr />
                        <p> &copy: 2015 Shunmian with jekyll. Theme: <a href="https://github.com/dbtek/dbyll"dbyll</a> by dbtek.
                        </p>
                    </footer>
                </div>
            </div>
        </div>
    </div>


    <script src="/assets/js/jquery-2.2.0.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/script.js"></script>
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    <script type="text/javascript">

$youziku.load(".sidebar_bio", "bdcc72b8235345649b02c123dac5610b", "SiYuan-ExtraLight");


   $youziku.draw();
</script>

</body>

</html>

